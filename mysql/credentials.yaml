credentials:
  root:
    user: root
    password: "I5Si9BySN0EdIY6"        # keep quotes so YAML doesnâ€™t treat as number
    host: "%"

serverInstances: 3
routerInstances: 1

datadirVolumeClaimTemplate:
  resources:
    requests:
      storage: 30Gi

tls:
  useSelfSigned: true

spec:
  mycnf: |
    [mysqld]
    slow_query_log = ON
    slow_query_log_file = /dev/stdout
    long_query_time = 2.5

service:
  type: LoadBalancer
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-type: "external"
    service.beta.kubernetes.io/aws-load-balancer-nlb-target-type: "instance"  # or "ip"
    service.beta.kubernetes.io/aws-load-balancer-scheme: "internal"

service:
  type: LoadBalancer
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-type: "external"
    service.beta.kubernetes.io/aws-load-balancer-nlb-target-type: "instance"  # or "ip"
    service.beta.kubernetes.io/aws-load-balancer-scheme: "internal"

podSpec:
  tolerations:
    - key: "mysql"
      operator: "Equal"
      value: "primary"
      effect: "NoSchedule"

  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        # avoid node with operator pod
        - labelSelector:
            matchLabels:
              app.kubernetes.io/name: mysql-operator
              app.kubernetes.io/instance: myoperator
          namespaces:
            - mysql-operator
          topologyKey: kubernetes.io/hostname

        # only 1 mysql-server pod per node
        - labelSelector:
            matchLabels:
              app.kubernetes.io/instance: mysql-innodbcluster-mycluster-mysql-server
          topologyKey: kubernetes.io/hostname

